function initialize(){input=document.getElementById("geolocalSearchTextField");autocomplete=new google.maps.places.Autocomplete(input);address=new google.maps.LatLng(45.769,3.09);mapOptions={zoom:17,mapTypeId:google.maps.MapTypeId.ROADMAP,center:address,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapition:google.maps.ControlPosition.TOP_LEFT}};map=new google.maps.Map(document.getElementById("geolocalMapHolder"),mapOptions);google.maps.event.trigger(map,"resize")}function getLocation(){$.msgBox({title:"Chargement...",content:"Chargement de l'itineraire...",type:"info",opacity:.9,showButtons:false,autoClose:true});if(navigator.geolocation){navigator.geolocation.getCurrentPosition(showPosition,showError)}else{x.innerHTML="La géolocalisation n'est pas supporté par le navigateur."}}function showPosition(e){address=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);mapOptions={zoom:17,center:address,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("geolocalMapHolder"),mapOptions);google.maps.event.trigger(map,"resize");myMarker=new google.maps.Marker({map:map,position:address})}function showError(e){switch(e.code){case e.PERMISSION_DENIED:x.innerHTML="Géolocalisation non authorisée.";break;case e.POSITION_UNAVAILABLE:x.innerHTML="Localisation non disponible.";break;case e.TIMEOUT:x.innerHTML="Echec de la localisation.";break;case e.UNKNOWN_ERROR:x.innerHTML="Erreur inconnue.";break}}function search_er(){var e,t;map=new google.maps.Map(document.getElementById("geolocalMapHolder"),mapOptions);autocomplete.bindTo("bounds",map);e=autocomplete.getPlace();if(typeof e==="undefined"||!e.geometry){return}if(e.geometry.viewport){map.fitBounds(e.geometry.viewport)}else{map.setCenter(e.geometry.location);map.setZoom(17)}t=new google.maps.InfoWindow({map:map,position:e.geometry.location,content:input.value})}var input,autocomplete,address,mapOptions,map,myMarker;$(document).ready(function(){initialize();getLocation()})